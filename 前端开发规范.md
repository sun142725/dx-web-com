# Web 规范
## 目的
 提高团队协作效率，便于后期开发维护

## 基本准则
### 可读易用，方便维护
>参考[W3C标准](https://www.w3cschool.cn/wzjszn/web-standards.html)

>为方便维护及二次开发，代码需要有以下特点:
```
    1. 代码可读性高，良好的注释、文档以及命名规范;
    2. 代码高度模块化，避免耦合度过高的代码，html/css/js 三个层面考虑;
    3. 代码风格一致性;
    4. 按照规范编写代码
```

# 规范
## 开发流程规范
### 方法及组件
 重复2-3遍甚至更多的方法或者组件 例如：大象页面需要使用公共cdn静态图片时，都需要执行如下代码，封装为公共组件后 [点击查看组件及组件使用](#img)

```html
<template>
<img class="address-img" :src="staticSourceServer+'/image/icon_address2.png'" />
</template>
<script>
import { staticSourceServer } from '@/utils/js/env.js'
export default{
    data: function(){
        return {
            staticSourceServer: staticSourceServer
        }
    }
}
</script>

```
### 缓存
使用[vuex](https://vuex.vuejs.org/zh/)来实现前端状态管理，使用vuex-persistedstate插件处理页面刷新vuex数据丢失情况
```javascript
1. vuex目录规范，见下文文件规范
2. 合理使用缓存，缓存用完需在合适的时机进行删除
3. 尽量使用vuex来管理跨页面状态，如有需要，则根据业务需求，去选用使用"sessionStorage"(关闭浏览器清除)或者"localStorage"(永久存在，需手动清除)
4. 在不必要的情况下无需使用缓存，如：跳转支付页只需url携带orderNumber，无需存储订单号、支付金额、过期时间问诊code等等增加耦合性

const commonStore = {
  state: {
    // 定义通用状态
    commonState: 0
  },
  mutations: {
    // 通过传入commonState的值改变通用状态  同步修改
    SET_COMMONSTATE: (state, commonState) => {
      state.commonState = commonState
    }
  },
  getters: {
    // 定义commonState计算获取状态仓库中当前模块的commonState
    commonState: state => state.commonState
  },
  actions: {
    // 定义setCommonState方法异步调用突变函数setCommonState来改变状态仓库commonStore中的commonState
    setCommonState: ({ commit }, commonState) => {
      return commit('SET_COMMONSTATE', commonState)
    }
  }
}
export default commonStore
```
### 提测
 ```
 1. 提测之后当前分支只修改测试提的相关bug,其他模块需要修改或可能影响到的地方提前与测试沟通
 ```

## File
### 文件资源命名
* 文件名建议只使用小写字母，不使用大写字母。( 为了醒目，某些说明文件的文件名，可以使用大写字母，比如README。 )
* 文件名包含多个单词时，单词之间建议使用半角的连词线 ( - ) 分隔(比如：person-info)
* 文件名与类名/函数名相同(比如)
```javascript
<!--文件名  fun.js-->
export function fun(){
    
}

<!--文件名  cardActiveMap.js-->
const CardActive = r => require.ensure([], () => r(require('@/components/CardActive.vue')), 'card')
export default function cardActiveMap() {
    let route = [{
        path: '/cardActive',
        component: CardActive
    }]
    return route
}
```


### 文件夹规范
* 待补充前端开发文档
```javascript
- assets/ // 静态文件
- components/ // 公共组件
    --component-name/ 
        ---component-name.vue // 组件代码
        ---component-name.scss // 组件样式
        ---component-name.md // 组件文档
- config/ // 配置文件
- plugin/ // 插件
- router/ // 路由文件
- store/ // 全局状态管理
    -- actions/ // 异步触发mutation，修改state
    -- module/ // 模块拥有自己的 state、mutation、action、getter
    -- index.js // store入口
- utils/ // 工具
    -- api/ // 后端接口二次封装
    -- js/ // 工具脚本
- views/ // 页面文件
    -- module-name/ // 所属模块
        --- components/ // 模块业务组件
        --- view-name/ // 页面
            ---- view-name.vue
            ---- view-name.scss
- main.js // 项目入口文件

```

## Vue

 [vue官方推荐使用规范](https://cn.vuejs.org/v2/style-guide/#%E4%BC%98%E5%85%88%E7%BA%A7-A%EF%BC%9A%E5%BF%85%E8%A6%81%E7%9A%84) 

### 组件命名
* 使用大驼峰命名方式( vue官方推荐 )
```
Vue.component('todo-item', {
  // ...
})
export default {
  name: 'TodoItem',
  // ...
}
```

### vue路由规范
* path 小写，单词以"-"分割
* name 使用小驼峰命名
* component 组件使用大驼峰
* meta 规范
```
{
    示例代码：
    {
      path: '/foo',
      component: Foo,
      children: [
        {
          path: 'bar',
          component: Bar,
          meta: { 
                title: '', // 页面名称
                keepLive: '', // 是否支持keep-live模式
                requireAuth: '', // bool 是否需要登陆权限true：需要；false：不需要 
                project: "" // string 所属项目 pharmacyShop/线上药房  medicalreport/美好卡
               }
        }
    ]
    }
```


### 推荐
> 组件props
```
不推荐
props: ["label", "value", "list"]
推荐
props: {
    label: {
            type: String,
            default: "label"
        },
    value: {
            type: String,
            default: "value"
        },
    list: {
            type: Array,
            default: ()=>{
                    return []
                }
        }
    }
```

### <a id="img">简单的img组件封装</a>

```html
<template>
    <img v-if="isLazy" v-lazy="staticSourceServer+'/image/icon_photo.png'" :alt="alt">
    <img v-else :src="staticSourceServer+'/image/icon_photo.png'" :alt="alt" />
</template>
<script>
import { staticSourceServer } from "@/utils/js/env.js"
export default {
  name: "EleOriginImg",
  props: {
      "is-lazy": { // 是否启动默认懒加载 默认false
          type: Boolean,
          default: false
      },
      "static-source-server": { // 静态文件远程地址，默认cdn地址
          type: String,
          default: staticSourceServer
      },
      "src": { // 文件路径
          type: String,
          default: '/image/icon_photo.png'
      },
      "alt": {
          type: String,
          default: ""
      }
  }
};
</script>

<!--注册为全局组件后，使用如下：-->
<ele-origin-img class="drug-img" src="/image/icon_photo.png"></ele-origin-img>
```

## Css
### 使用规范
* 大象h5使用vw进行移动端适配，[文档注解](http://note.youdao.com/noteshare?id=0e2b2d8e46d5ee94a8c66ceab97dd8b0)
* 推荐使用class命名进行样式分离，`禁用行内样式`
* 使用flex进行移动端布局，`禁用float`
* 定位布局推荐使用relative/absolute搭配使用，`禁用fiexd`

### 样式属性顺序
* 位置信息(position、top、z-index、display)
* 盒模型(width,height,box-sizing,padding,margin,border,overflow)
* 文本(font-size,line-height,text-align)
* 外观(color,background，animation等)
```css
// 例如
.box{
    display: block;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    font-size: 20px;
    color: red;
    ...
}
```

### 选择器命名规则
* class 命名方式 使用 "-" ------- * 优先class命名
* id 命名方式 使用小驼峰  ------- 注：不要滥用id,避免同一页面出现一样的id

> 推荐盒模型 box-sizing：border-box

> 充分利用scss，对主题色，字体大小等进行变量定义,例如：

```scss
$grey-e5: #e5e5e5;
$grey-b2: #b2b2b2;
$blue-light: #298dfb;

$font-24: pxToVW(24);
```

### scss 工具
基于工具实现 [1px](http://note.youdao.com/noteshare?id=aef1636410789c5f0b4d3bc560a988d8&sub=36AC263404144660A8906F3AB9B6B522) 像素方案
利用scss mixin 封装css工具，开发过程中优先使用工具;如下：
```scss
@mixin top-bottom {
    position: absolute;
    top: 0;
    bottom: 0;
    margin: auto;
  }
  
  @mixin left-right {
    position: absolute;
    left: 0;
    right: 0;
    margin: auto;
  }
  
  @mixin position-center {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    margin: auto;
  }
  @mixin position-center2 {
    position: absolute;
    top:50%;
    left:50%;
    transform: translate(-50%,-50%);
  }
  
  
  @mixin rect($w,$h) {
    width: $w;
    height: $h;
  }
  ...  ...
  
.box{
    @include position-center();
    @include rect(200);
}
  
```


## Javascript
### 变量命名
#### 普通变量
* 命名方法 : 小驼峰 
#### 常量
* 命名方法 : 全部大写
* 命名规范 : 使用大写字母和下划线来组合命名，下划线用以分割单词。
    推荐： 
```javascript
// 普通变量  小驼峰
let doctorCode = '123213214';
let userCode = '18354565845';

// 常量 大驼峰
const MAX_COUNT = 10;
```

### 函数命名
* 命名方式 : 小驼峰方式 ( 构造函数使用大驼峰命名法 )
* 命名规则 : 前缀为动词 例如：`checkData` `isShow` `getData`等。
```
-- can
    判断是否可执行某个动作 ( 权限 ), 函数返回一个布尔值。 
    true：可执行； false：不可执行
    
-- has
    判断是否含有某个值,  函数返回一个布尔值。  true：含有此值；false：不含有此值

-- is
    判断是否为某个值,  函数返回一个布尔值。  true：为某个值；false：不为某个值
    
-- check
    检查某项数据是否正确或符合对应规则， 函数返回一个布尔值。 
    true：符合  false：不符合

-- get
    获取某个值, 函数返回一个非布尔值

-- set
    设置某个值,  无返回值、返回是否设置成功或者返回链式对象
```

### 注释规范
#### 单行注释
* // (双斜线)与注释文字之间保留一个空格
* (双斜线)与代码之间保留一个空格，并且//(双斜线)与注释文字之间保留一个空格。

#### 多行注释
* /*  注释内容  */
* 函数 ( 方法 ) 注释
```javascript
//  单行注释
var maxCount = 10; // 设置最大量

/** 
* 函数说明 
* @关键字 { 参数类型 } 参数名称  参数描述
*/

/** 
* 获取医生名称 
* @param { string } doctorCode  医生code
* @return { string } doctorName  医生名称
*/
function getName(doctorCode){
    return "doctorName"
}
```

## 推荐

### 首选es6函数式风格 建议查看[阮一峰es6](http://es6.ruanyifeng.com/)
```javascript
let str = "string"
const MAX_COUNT = 16

// 模板字符串
let longStr = `THis is ${str}`
// 解构赋值
let { bar, foo } = { foo: 'aaa', bar: 'bbb' };
foo // "aaa"
bar // "bbb"
// 箭头函数
()=>{}
...
```

### 条件判断赋值优先使用三元表达式

```javascript
// 例如：
if(true){
    console.log(1);
} else {
    console.log(2);
}
// 写为
true ? console.log(1) : console.log(2);

// 不推荐 a === b && c = '123' 类似这样的写法，建议使用if-else或三元表达式代替
```



### console()规范化
```javascript
let a = 1
// 不建议
console.log(a)
console.log("222111", a)
// 建议 表明具体描述
console.log("a的值为：", a)
console.log("加密前：", data)
console.log("加密后：", md5(data))
```

### <a id="api">api接口二次封装</a>

```javascript
<!-- 上传文件 -->
export function uploadFile(data) {
    return requestApi.Post({url: '/syssms/sysFile/uploadFile', data: data})
}
```



